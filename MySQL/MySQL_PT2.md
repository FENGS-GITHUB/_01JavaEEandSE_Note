# 约束

定义约束:

- PRIMARY KEY 主键约束 行的唯一标识 非空且不重复
- UNIQUE 唯一约束 后加AUTO_INCREMENT自动增长
- NOT NULL  非空约束,不能为NULL
- DEFAULT 设定默认值替代NULL
- FOREIGN KEY 外键约束,与其他表建立连接
- CHECK MySQL不支持

修改约束:

- ALTER TABLE 表名 ALTER 列名 SET DEFAULT 默认值;
- ALTER TABLE 表名 ALTER 列名 DROP DEFAULT;

**外键约束:**

主表:被关联的表.

从表:依赖于( REFERENCES)主表

**定义时约束:**

- CONSTRAINT 外键名称 FOREIGN KEY(本表列名) REFERENCES 主表(关联列);
- ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (本表列名) REFERENCES 主表(主表列名);

# 表设计

## 一对多

一个主表行对应多个从表行,从表关联主表.

例如部门与员工关系:

主表部门表,从表员工表

一个部门可对应多个员工

员工从表,部门主表

## 多对多

两个表的行可以自由搭配,需要一个中间表作为从表,从表行为两个主表的排列组合

例如付款方式和商品的关系:

付款方式表和商品表全部为主表

中间表为从表,表示两个表之间所有关系

## 一对一

两个表的行为一一对应,两个表主从任意,通过主键与主键建立外键约束实现

例如身份表和电话号码表的关系:

身份证号和电话号都是主键,非空且唯一

这两个键建立联系后,实现一行对一行

# 多表查询

## 相关联两表查询:

**区分某表的某列: 表名.列名 表示**

- ~~select * from 表1 , 表2; 查询这两个表的所有排列组合,行数为:表1行数*表2行数,不符合规定~~
- select * from 表1 , 表2 where 从表外键=主表关联键;

## 内连接:

- select * from 从表 inner join 主表 on 从表主键 = 主表关联键;

内连接就是主表和从表的交集数据.

## 外连接:

- SELECT 列 FROM 从表 LEFT OUTER JOIN 主表 ON 条件;
- SELECT 列 FROM 从表 RIGHT OUTER JOIN 主表 ON 条件;

引入左右外连接的原因就是为了实现当从表或主表存在不关联行时(外键为NULL或者主表关联键为NULL),在展现二表之间交集的同时展示出从表或主表的剩余内容.

#  子查询=嵌套查询

通过嵌套查询来实现两部查询合成一部

# 事务

事务就是将一组查询语句依次执行,当出现问题时可以进行撤销(回滚)操作.

该种方式实现了操作的撤销与提交:

1. 首先执行BEGIN;语句,意味着一个事务的开始
2. 之后执行事务语句
3. 出现错误执行ROLLBACK;语句,使数据库状态回复至BEGIN语句执行时之前.
4. 无错误则执行COMMIT;语句进行提交,使数据库接受事务语句更改.

